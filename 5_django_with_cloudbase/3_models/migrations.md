# Django Migration

## 为什么需要Migration

见[文章](https://nextlinklabs.com/insights/naming-django-migrations-improving-projects)给的理由。

## 技术规范

### 命名迁移文件

为每一个migration文件命名一个可读的名字，类似于Django官方应用做的。命名风格统一采用官方习惯的动名词短语。

### 谨慎删除字段

尽可能避免，除非确定不影响业务逻辑。否则在生产环境丢失数据需要一系列回退，可能比较麻烦，我们目前还没有维护它的方案。

### 本地调试通过后再提交

（要求）在本地调试通过以后再提交migration文件，云端数据库目前缺乏运行命令行工具的方法，数据库做了迁移以后无法运行回退命令。还需要寻找方案升级云端开发环境，比如Nocalhost；暂时在需要改迁移时关闭提交自动触发开发环境构建命令，使用手动触发并保证在本地测试覆盖完善以后提交。

（建议）在开发调试过程中经常产生过多的migration，希望可以尽量在提交时减少migration以更清楚每次更新的数据库情况（类似于一个字段反复修改），或者减少生产中可能出现的异常（比如改主键在SQLite可以在MySQL异常）。
